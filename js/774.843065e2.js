"use strict";(self["webpackChunkbos_designer"]=self["webpackChunkbos_designer"]||[]).push([[774],{7774:function(t,e,s){s.r(e),s.d(e,{default:function(){return m}});var r=function(){var t=this,e=t._self._c;return e("main",{staticClass:"box-border h-full min-h-[calc(100vh-84px)] w-full pb-[84px]"},[e("C-Back-Nav",{attrs:{title:"行事曆",routeTarget:{name:"ScheduleBreak"}}}),t.resultItem?e("section",{staticClass:"relative z-0 mt-[52px] p-3"},[e("div",{staticClass:"m-auto mt-4 max-w-[475px] rounded-lg p-2 text-left shadow-[0_4px_10px_3px_rgba(0,0,0,0.1)]"},[e("p",{staticClass:"mb-2 text-center text-lg font-semibold"},[t._v(t._s(t.$route.query.isReview?"預約內容":"預約明細"))]),e("div",{staticClass:"mb-2 flex items-center border-b border-solid border-primary/5 pb-1"},[e("p",{staticClass:"w-1/3 font-bold"},[t._v("預約時間:")]),t.isEdit?e("p",{staticClass:"w-1/3"},[e("vc-date-picker",{attrs:{mode:"dateTime",is24hr:"","min-date":t.$dayjs().format("YYYY-MM-DD")},scopedSlots:t._u([{key:"default",fn:function({inputValue:s,inputEvents:r}){return[e("input",t._g({staticClass:"rounded border px-2 py-1 focus:border-blue-300 focus:outline-none",attrs:{placeholder:"請選擇日期"},domProps:{value:s}},r))]}}],null,!1,3631880005),model:{value:t.resultItem.date,callback:function(e){t.$set(t.resultItem,"date",e)},expression:"resultItem.date"}})],1):t._e(),t.isEdit?t._e():e("p",{staticClass:"w-1/3"},[t._v(t._s(t._f("dateFmtROCMMDD")(t.resultItem.date)))]),t.isEdit?t._e():e("p",{staticClass:"w-1/3"},[t._v(t._s(t._f("dateFmtHm")(t.resultItem.date)))])]),e("div",{staticClass:"mb-2 flex items-center border-b border-solid border-primary/5 pb-1"},[e("p",{staticClass:"w-1/3 font-bold"},[t._v("姓名:")]),t.isEdit?e("C-Input",{staticClass:"!m-0",attrs:{placeholder:"輸入客戶姓名"},model:{value:t.resultItem.customer.name,callback:function(e){t.$set(t.resultItem.customer,"name",e)},expression:"resultItem.customer.name"}}):e("p",{staticClass:"w-2/3"},[t._v(t._s(t.resultItem.customer.name))])],1),e("div",{staticClass:"mb-2 flex items-center border-b border-solid border-primary/5 pb-1"},[e("p",{staticClass:"w-1/3 font-bold"},[t._v("電話:")]),t.isEdit?e("C-Input",{staticClass:"!m-0",attrs:{placeholder:"輸入客戶姓名"},model:{value:t.resultItem.customer.cellphone,callback:function(e){t.$set(t.resultItem.customer,"cellphone",e)},expression:"resultItem.customer.cellphone"}}):e("p",{staticClass:"w-2/3"},[t._v(t._s(t.resultItem.customer.cellphone))])],1),e("div",{staticClass:"mb-2 flex items-center border-b border-solid border-primary/5 pb-1"},[e("p",{staticClass:"w-1/3 font-bold"},[t._v("設計師:")]),e("p",{staticClass:"w-2/3",class:{"text-rejectText font-extrabold":t.userInfo.user.id!==t.resultItem.designer.id}},[t._v(t._s(t.resultItem.designer?t.resultItem.designer.name:t.resultItem.designer))])]),e("div",{staticClass:"mb-2 flex items-center border-b border-solid border-primary/5 pb-1"},[e("p",{staticClass:"w-1/3 font-bold"},[t._v(t._s(t.isEdit?"指定預約":"指定/不指定"))]),t.isEdit?e("C-Checkbox-Full",{staticClass:"!ml-0 !w-fit",attrs:{label:"指定/不指定"},model:{value:t.resultItem.isDesignate,callback:function(e){t.$set(t.resultItem,"isDesignate",e)},expression:"resultItem.isDesignate"}}):e("p",{staticClass:"w-2/3"},[t._v(t._s(t.resultItem.isDesignate?"指定":"不指定"))])],1),e("div",{staticClass:"mb-2 flex border-b border-solid border-primary/5 pb-1"},[e("label",{staticClass:"w-1/3 font-bold"},[t._v("我的備註:")]),e("div",{staticClass:"relative w-2/3"},[t.isEdit?e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.resultItem.remark,expression:"resultItem.remark"}],staticClass:"w-full rounded-md border border-primary/50",attrs:{name:"remark",id:"",rows:"5"},domProps:{value:t.resultItem.remark},on:{input:function(e){e.target.composing||t.$set(t.resultItem,"remark",e.target.value)}}}):e("p",[t._v(t._s(t.resultItem.remark))]),""!==t.resultItem.remark&&t.isEdit?e("font-awesome-icon",{staticClass:"absolute right-2 bottom-2 text-rose-600",attrs:{icon:"fa-regular fa-xmark"},on:{click:function(e){t.resultItem.remark=""}}}):t._e()],1)]),e("div",{staticClass:"mb-2 flex border-b border-solid border-primary/5 pb-1"},[e("label",{staticClass:"w-1/3 font-bold"},[t._v("顧客備註:")]),e("div",{staticClass:"relative w-2/3"},[e("p",{staticClass:"w-full",attrs:{name:"remark"}},[t._v(t._s(t.resultItem.remarkForCustomer))])])]),e("div",{staticClass:"mb-2 flex border-b border-solid border-primary/5 pb-1"},[e("label",{staticClass:"w-1/3 font-bold"},[t._v("留言給顧客:")]),e("div",{staticClass:"relative w-2/3"},[t.isEdit?e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.resultItem.messageForCustomer,expression:"resultItem.messageForCustomer"}],staticClass:"w-full rounded-md border border-primary/50",attrs:{name:"messageForCustomer",rows:"5"},domProps:{value:t.resultItem.messageForCustomer},on:{input:function(e){e.target.composing||t.$set(t.resultItem,"messageForCustomer",e.target.value)}}}):e("p",[t._v(t._s(t.resultItem.messageForCustomer))]),""!==t.resultItem.messageForCustomer&&t.isEdit?e("font-awesome-icon",{staticClass:"absolute right-2 bottom-2 text-rose-600",attrs:{icon:"fa-regular fa-xmark"},on:{click:function(e){t.resultItem.messageForCustomer=""}}}):t._e()],1)])]),"待審查"===t.resultItem.status?e("div",{staticClass:"mt-4"},[e("p",{staticClass:"text-center text-lg font-semibold"},[t._v("選擇審查狀態")]),e("div",{staticClass:"m-auto flex max-w-[475px] justify-around p-2"},[e("div",{staticClass:"w-1/3 cursor-pointer rounded bg-sucessText px-[14px] py-2 text-sm text-white",on:{click:function(e){return t.toggleDialog("accept")},keypress:function(e){return t.toggleDialog("accept")}}},[t._v("接單")]),e("div",{staticClass:"w-1/3 cursor-pointer rounded bg-rejectText px-[14px] py-2 text-sm text-white",on:{click:function(e){return t.toggleDialog("reject")},keypress:function(e){return t.toggleDialog("reject")}}},[t._v("拒絕")])])]):t._e(),t.userInfo.user.id===t.resultItem.designer.id?["待審查"!==t.resultItem.status&&"已完成"!==t.resultItem.status?e("div",{staticClass:"mt-4"},[e("p",{staticClass:"text-center text-lg font-semibold"},[t._v("選擇審查狀態")]),e("div",{staticClass:"m-auto flex max-w-[475px] justify-around p-2"},[e("div",{staticClass:"flex w-1/3 cursor-pointer items-center justify-center gap-2 rounded bg-sucessText px-[14px] py-2 text-sm text-white",on:{click:function(e){return t.updateVerifyBookingInput(t.resultItem,!0)},keypress:function(e){return t.updateVerifyBookingInput(t.resultItem,!0)}}},["預約成功"===t.resultItem.status?e("font-awesome-icon",{staticClass:"animate__animated animate__heartBeat animate__fast text-xl",attrs:{icon:"fa-regular fa-circle-check"}}):t._e(),e("span",[t._v("接單")])],1),e("div",{staticClass:"flex w-1/3 cursor-pointer items-center justify-center gap-2 rounded bg-rejectText px-[14px] py-2 text-sm text-white",on:{click:function(e){return t.updateVerifyBookingInput(t.resultItem,!1)},keypress:function(e){return t.updateVerifyBookingInput(t.resultItem,!1)}}},["設計師已取消"===t.resultItem.status?e("font-awesome-icon",{staticClass:"animate__animated animate__heartBeat animate__fast text-xl",attrs:{icon:"fa-regular fa-circle-check"}}):t._e(),e("span",[t._v("拒絕")])],1)])]):t._e(),"0"!==t.resultItem.status?e("div",{staticClass:"m-auto flex max-w-[475px] justify-around p-2"},[e("div",{staticClass:"w-full cursor-pointer bg-second py-2 px-4 text-white",on:{click:function(e){t.doSubmitEdit(),t.isEdit=!t.isEdit},keypress:function(e){t.doSubmitEdit(),t.isEdit=!t.isEdit}}},[t._v(t._s(t.isEdit?"儲存預約":"修改預約"))])]):t._e()]:t._e()],2):t._e()],1)},a=[],i=(s(7658),s(629)),o={name:"order-edit",description:"預約單的審查",metaInfo:{title:"BeautyOS 設計師",titleTemplate:"%s | 預約"},mounted(){this.init()},data(){return{date:"",time:"",isEdit:!1,resultItem:null}},activated(){this.init()},methods:{async init(){await this.getOrder(this.$route.query.id)},doRoute(){this.$router.push({name:"ScheduleBreak"})},async getOrder(t){const e=await this.$api.order({orderId:t}),{data:s,errors:r}=e.data;return r?{}:(this.resultItem=s.order,e)},async doSubmitEdit(){if(!this.isEdit)return;const t=await this.$api.updateBooking({id:this.$route.query.id,remark:this.resultItem.remark,isDesignate:this.resultItem.isDesignate,messageForCustomer:this.resultItem.messageForCustomer,date:new Date(this.resultItem.date).getTime(),customerCellphone:this.resultItem.customer.cellphone,customerName:this.resultItem.customer.name}),{data:e,errors:s}=t.data;s||(this.resultItem=e.updateBooking,this.$swal.fire({title:" ",html:'<div class="flex items-center justify-center">\n          <img src="/designer/assets/images/success.svg" alt="" class="inline-block mr-1" /><span>修改成功</span>\n        </div>\n        <br/>',confirmButtonText:"回到列表",showConfirmButton:!0,showCloseButton:!0,customClass:{confirmButton:"!w-[144px] !rounded !bg-second !px-[14px] !py-2 !text-sm !text-white"}}).then((t=>{t.isConfirmed&&this.doRoute()})))},toggleDialog(t){this.$swal.fire({input:"text",title:" ",html:`<div class="flex items-center justify-center">\n          ${"accept"===t?'<img src="/designer/assets/images/success.svg" alt="" class="inline-block mr-1" /><span>確認接單</span>':'<img src="/designer/assets/images/error.svg" alt="" class="inline-block mr-1" /><span>已拒絕</span>'}\n        </div>`,inputPlaceholder:"請輸入備註說明",confirmButtonText:"送出",showConfirmButton:!0,showCloseButton:!0,showClass:{popup:"animate__animated animate__fadeInDown"},hideClass:{popup:"animate__animated animate__fadeOutUp animate__faster"},customClass:{confirmButton:"!w-[144px] !rounded !bg-second !px-[14px] !py-2 !text-sm !text-white"}}).then((e=>{e.isConfirmed&&this.$swal.fire({showCloseButton:!0,html:`<div class="flex items-center justify-center my-10">\n              ${"accept"===t?'<img src="/designer/assets/images/success.svg" alt="" class="inline-block mr-1" /><span>接單成功</span>':'<img src="/designer/assets/images/error.svg" alt="" class="inline-block mr-1" /><span>拒絕成功</span>'}\n            </div>`,showConfirmButton:!1,timer:3e3,timerProgressBar:!0}).then((()=>{this.doRoute()}))}))},async updateVerifyBookingInput(t,e){if("預約成功"===t.status&&e)return;if("設計師已取消"===t.status&&!e)return;const s=await this.$api.VerifyBookingInput({orderId:t.id,isApproval:e}),{errors:r}=s.data;r||await this.getOrder(this.$route.query.id)}},computed:{...(0,i.rn)("userInfo",["userInfo"])}},l=o,n=s(3736),u=(0,n.Z)(l,r,a,!1,null,"1ed78d0a",null),m=u.exports}}]);
//# sourceMappingURL=774.843065e2.js.map