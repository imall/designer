"use strict";(self["webpackChunkbos_designer"]=self["webpackChunkbos_designer"]||[]).push([[369],{5369:function(e,t,i){i.r(t),i.d(t,{default:function(){return c}});var s=function(){var e=this,t=e._self._c;return t("main",{staticClass:"box-border h-full min-h-[calc(100vh-84px)] w-full pb-[84px]"},[t("C-Back-Nav",{attrs:{title:"價目表"}}),t("section",{staticClass:"relative z-0 mt-[52px] p-3"},[t("ul",[t("C-Draggable",{staticClass:"list-group scrollnone nav nav-tabs mb-4 flex list-none overflow-x-auto border-b border-solid border-primary pl-0",attrs:{handle:".moveable",disabled:!e.enabled,"ghost-class":"ghost"},on:{change:e.bookingItemCategoryMove,start:function(t){e.dragging=!0},end:function(t){e.dragging=!1}},model:{value:e.BookingItemCategory,callback:function(t){e.BookingItemCategory=t},expression:"BookingItemCategory"}},[e._l(e.BookingItemCategory,(function(i){return t("li",{key:i.id,class:[""+(e.seletedTab===i.id?"border-b-2 border-solid border-primary":"")],on:{click:function(t){return e.handleCategory(i.id)},keypress:function(t){return e.handleCategory(i.id)}}},[t("p",{staticClass:"whitespace-nowrap p-3 text-base"},[t("font-awesome-icon",{staticClass:"moveable inline-block w-[20px]",attrs:{icon:"fa-solid fa-grip-dots-vertical"}}),e._v(" "+e._s(i.name)+" "),t("font-awesome-icon",{staticClass:"ml-1",attrs:{icon:"fa-regular fa-pencil"},on:{click:function(t){return e.updateBookingItemCategory(i)}}})],1)])})),t("li",[t("p",{staticClass:"whitespace-nowrap p-3 text-base"},[t("font-awesome-icon",{attrs:{icon:"fa-regular fa-circle-plus"},on:{click:function(t){return e.createBookingItemCategory()}}})],1)])],2)],1),0!==e.BookingItemCategory.length?[t("div",{staticClass:"animate__animated animate__fadeIn animate__fast"},[e._m(0),t("div",{staticClass:"px-2"},[t("div",{staticClass:"mt-1 flex items-center border-b border-solid border-primary/50 text-left"},[t("div",{staticClass:"w-3/12"},[t("C-Checkbox-Full",{attrs:{label:"全選"},model:{value:e.isSelectAll,callback:function(t){e.isSelectAll=t},expression:"isSelectAll"}})],1),t("div",{staticClass:"w-2/12 mr-2"},[t("div",{on:{click:function(t){return e.createBookingItem()},keypress:function(t){return e.createBookingItem()}}},[t("font-awesome-icon",{staticClass:"text-lg",attrs:{icon:"fa-regular fa-circle-plus"}}),e._v(" 新增 ")],1)]),t("div",{staticClass:"w-2/12 mr-2"},[t("div",{on:{click:function(t){return e.deleteBookingItem(e.resultList)},keypress:function(t){return e.deleteBookingItem(e.resultList)}}},[t("font-awesome-icon",{staticClass:"text-lg",attrs:{icon:"fa-solid fa-trash-can"}}),e._v(" 刪除 ")],1)]),t("div",{staticClass:"w-2/12 mr-2"},[t("div",{on:{click:function(t){return e.changeBookingItemUsing(e.resultList,!0)},keypress:function(t){return e.changeBookingItemUsing(e.resultList,!0)}}},[t("font-awesome-icon",{attrs:{icon:"fa-solid fa-up-from-bracket"}}),e._v(" 上架 ")],1)]),t("div",{staticClass:"w-2/12 mr-2"},[t("div",{on:{click:function(t){return e.changeBookingItemUsing(e.resultList,!1)},keypress:function(t){return e.changeBookingItemUsing(e.resultList,!1)}}},[t("font-awesome-icon",{attrs:{icon:"fa-solid fa-down-to-bracket"}}),e._v(" 下架 ")],1)])]),t("C-Draggable",{staticClass:"list-group",attrs:{handle:".moveable",list:e.resultList,disabled:!e.enabled,"ghost-class":"ghost"},on:{change:e.bookingItemMove,start:function(t){e.dragging=!0},end:function(t){e.dragging=!1}}},e._l(e.resultList,(function(i){return t("div",{key:i.id,staticClass:"mt-2 flex items-center gap-2 border-b border-solid border-primary/50 text-left"},[t("div",{staticClass:"w-2/12"},[t("C-Checkbox-Full",{model:{value:i.checked,callback:function(t){e.$set(i,"checked",t)},expression:"item.checked"}})],1),t("div",{staticClass:"w-5/12",class:[""+(i.isUsing?"":"text-slate-400")]},[t("span",[e._v(e._s(i.isUsing?"":"(下架)")+" "+e._s(i.name))])]),t("div",{staticClass:"w-6/12 text-right",class:[""+(i.isUsing?"":"text-slate-400")]},[t("span",[e._v("$"+e._s(i.showPrice))])]),t("div",{staticClass:"w-1/12 text-center",on:{click:function(t){return e.deleteSingleBookingItem(i)},keypress:function(t){return e.deleteSingleBookingItem(i)}}},[t("font-awesome-icon",{staticClass:"text-lg",attrs:{icon:"fa-solid fa-trash-can"}})],1),t("div",{staticClass:"w-1/12 text-center",on:{click:function(t){return e.updateBookingItem(i)},keypress:function(t){return e.updateBookingItem(i)}}},[t("font-awesome-icon",{staticClass:"text-lg",attrs:{icon:"fa-regular fa-pencil"}})],1),t("div",{staticClass:"moveable text-center w-1/12"},[t("font-awesome-icon",{staticClass:"mr-1",attrs:{icon:"fa-solid fa-grip-dots-vertical"}})],1)])})),0)],1),0===e.resultList.length?t("p",{staticClass:"py-2"},[e._v(" 點擊"),t("font-awesome-icon",{staticClass:"mx-1",attrs:{icon:"fa-regular fa-circle-plus"}}),e._v("新增項目 ")],1):t("p",{staticClass:"py-2"},[e._v(" 拖曳"),t("font-awesome-icon",{staticClass:"mx-1",attrs:{icon:"fa-solid fa-grip-dots-vertical"}}),e._v("符號變更順序 ")],1)])]:[t("div",[0===e.resultList.length?t("p",{staticClass:"py-2"},[e._v(" 點擊"),t("font-awesome-icon",{staticClass:"mx-1",attrs:{icon:"fa-regular fa-circle-plus"}}),e._v("新增項目類別 ")],1):e._e()])]],2)],1)},o=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"px-2"},[t("div",{staticClass:"mt-2 flex border-b border-solid border-primary/50 text-left"},[t("div",{staticClass:"w-9/12"},[e._v("服務／產品名稱")]),t("div",{staticClass:"w-3/12"},[e._v("售價")])])])}],n={name:"priceList-index",description:"價目表的首頁",metaInfo:{title:"BeautyOS 設計師",titleTemplate:"%s | 價目表"},data(){return{isSelectAll:!1,enabled:!0,seletedTab:"",BookingItemCategory:[],resultList:[]}},mounted(){this.getBookingItemCategory()},methods:{async getBookingItemCategory(e,t){const i=await this.$api.getBookingItemCategory(),{data:s,errors:o}=i.data;if(o)return;if(this.BookingItemCategory=s.getBookingItemCategory,0===s.getBookingItemCategory.length)return;const n=Math.min(...this.BookingItemCategory.map((e=>e.sort))),a=t?Math.max(...this.BookingItemCategory.map((e=>e.sort))):null;this.seletedTab=e||this.BookingItemCategory.filter((e=>a?e.sort===a:e.sort===n))[0].id;const{bookingItem:r}=this.seletedTab?this.BookingItemCategory.filter((e=>e.id===this.seletedTab))[0]:this.BookingItemCategory.filter((e=>0===e.sort))[0];this.handleBookingItem(r,!1)},async createBookingItemCategory(){this.$swal.fire({title:"新增項目類別",input:"text",confirmButtonText:"新增",cancelButtonText:"取消",showConfirmButton:!0,showCancelButton:!0,showCloseButton:!0,customClass:{input:"!w-[50%] !m-auto !text-center",title:"!pb-5"},preConfirm:e=>{""===e&&this.$swal.showValidationMessage("請輸入名稱")}}).then((async e=>{if(e.isDismissed)return"";if(e.isConfirmed){const t={name:e.value},i=await this.$api.createBookingItemCategory(t),{data:s,errors:o}=i.data;if(o)return"";s.createBookingItemCategory&&(await this.getBookingItemCategory("",!0),this.$swal.fire({icon:"success",title:"編輯成功",showConfirmButton:!1,showCloseButton:!0,timer:3e3,timerProgressBar:!0}))}return""}))},async updateBookingItemCategory(e){e.id===this.seletedTab&&this.$swal.fire({title:"編輯或刪除項目",input:"text",inputValue:e.name,confirmButtonText:"儲存編輯",cancelButtonText:"取消",denyButtonText:"刪除項目",showConfirmButton:!0,showCancelButton:!0,showDenyButton:!0,showCloseButton:!0,customClass:{input:"!w-[50%] !m-auto !text-center",title:"!pb-5"},preConfirm:e=>{""===e&&this.$swal.showValidationMessage("請輸入名稱")}}).then((async t=>{if(t.isDenied&&this.$swal.fire({icon:"warning",html:'<p class="py-3 text-lg">確定要刪除項目嗎？</p>',showConfirmButton:!0,showCloseButton:!0,showCancelButton:!0,confirmButtonText:"確定",cancelButtonText:"取消"}).then((async t=>{if(t.isConfirmed){const t={bookingItemCategoryId:e.id},i=await this.$api.deleteBookingItemCategory(t),{data:s,errors:o}=i.data;if(o)return;s.deleteBookingItemCategory&&(await this.getBookingItemCategory("",!1),this.$swal.fire({icon:"success",title:"刪除成功",showConfirmButton:!1,showCloseButton:!0,timer:3e3,timerProgressBar:!0}))}})),t.isConfirmed){const i={input:{bookingItemCategoryId:e.id,name:t.value}},s=await this.$api.updateBookingItemCategory(i),{data:o,errors:n}=s.data;if(n)return"";o.updateBookingItemCategory&&(await this.getBookingItemCategory(this.seletedTab,!1),this.$swal.fire({icon:"success",title:"編輯成功",showConfirmButton:!1,showCloseButton:!0,timer:3e3,timerProgressBar:!0}))}return""}))},async createBookingItem(){const{value:e}=await this.$swal.fire({title:"新增項目",html:'\n                <style>\n            #up{\n                margin-right: -10px;\n            }\n            .hightest-price {\n                display: none;\n            }\n\n            #isHighestPrice:checked~.hightest-price {\n                display: block;\n            }\n        </style>\n <div class="my-2">\n            <label class="w-4/12 inline-block" for="name">項目名稱 <sup class="text-red-500">*</sup></label>\n            <input id="name" class=" w-7/12 rounded border p-2" placeholder="請輸入項目名稱"  />\n        </div>\n        <div class="my-2">\n            <label class="w-4/12 inline-block" for="lowestPrice">最低價 <sup class="text-red-500">*</sup></label>\n            <input id="lowestPrice" class="w-4/12 rounded border p-2" placeholder="請輸入最低價"  />\n            <input type="checkbox" id="up" class="w-1/12 rounded border p-2 my-2" />\n            <label class="w-2/12 inline-block my-2" for="up">元起</label>\n        </div>\n        <div class="my-2 pb-5">\n            <input type="checkbox" id="isHighestPrice" class="w-1/12 rounded border p-2 my-2" />\n            <label class="w-4/12 inline-block my-2" for="isHighestPrice">輸入最高價</label>\n            <br>\n            <div class="hightest-price">\n                <label class="w-4/12 inline-block" for="highestPrice">最高價</label>\n                <input id="highestPrice" class=" w-7/12 rounded border p-2" placeholder="請輸入最高價"  />\n            </div>\n        </div>\n        ',focusConfirm:!1,confirmButtonText:"儲存編輯",cancelButtonText:"取消",showCancelButton:!0,preConfirm:()=>{const e=document.getElementById("name").value,t=document.getElementById("lowestPrice").value;let i=document.getElementById("highestPrice").value;const s=document.getElementById("isHighestPrice").checked,o=document.getElementById("up").checked;return s||""===i||(i=""),this.examInput(e,t,i),""!==i||o?{name:e,lowestPrice:t,highestPrice:i}:{name:e,lowestPrice:t,highestPrice:t}}});if(e){const t=""===e.highestPrice?null:+e.highestPrice,i={input:{bookingItemCategoryId:this.seletedTab,name:e.name,lowestPrice:+e.lowestPrice,highestPrice:t}},s=await this.$api.createBookingItem(i),{data:o,errors:n}=s.data;return n||o.createBookingItem&&(await this.getBookingItemCategory(this.seletedTab,!1),this.$swal.fire({icon:"success",title:"新增成功",showConfirmButton:!1,showCloseButton:!0,timer:3e3,timerProgressBar:!0})),""}return""},async updateBookingItem(e){let{name:t}=e,{lowestPrice:i}=e,s=e.highestPrice?e.highestPrice:"",o=e.isUsing?"checked":"",n=null===e.highestPrice||""===e.highestPrice||e.highestPrice===e.lowestPrice?"":"checked",a=null===e.highestPrice||""===e.highestPrice?"checked":"";const{value:r}=await this.$swal.fire({title:"編輯項目",html:`\n        <style>\n            #up{\n                margin-right: -10px;\n            }\n            .hightest-price {\n                display: none;\n            }\n\n            #isHighestPrice:checked~.hightest-price {\n                display: block;\n            }\n        </style>\n        <div class="my-2">\n            <label class="w-4/12 inline-block" for="name">項目名稱 <sup class="text-red-500">*</sup></label>\n            <input id="name" class=" w-7/12 rounded border p-2" placeholder="請輸入項目名稱" value="${t}" />\n        </div>\n        <div class="my-2">\n            <label class="w-4/12 inline-block" for="lowestPrice">最低價 <sup class="text-red-500">*</sup></label>\n            <input id="lowestPrice" class="w-4/12 rounded border p-2" placeholder="請輸入最低價" value="${i}" />\n            <input type="checkbox" id="up" class="w-1/12 rounded border p-2 my-2" ${a} />\n            <label class="w-2/12 inline-block my-2" for="up">元起</label>\n        </div>\n        <div class="my-2 ">\n            <input type="checkbox" id="isHighestPrice" class="w-1/12 rounded border p-2 my-2"  ${n}/>\n            <label class="w-4/12 inline-block my-2 text-left" for="isHighestPrice">輸入最高價</label>\n            <br>\n            <div class="hightest-price">\n                <label class="w-4/12 inline-block" for="highestPrice">最高價</label>\n                <input id="highestPrice" class=" w-7/12 rounded border p-2" placeholder="請輸入最高價" value="${s}" />\n            </div>\n        </div>\n        <div class="my-2">\n            <input type="checkbox" id="isUsing" class="w-1/12 rounded border p-2" ${o} />\n            <label class="w-4/12 inline-block text-left" for="isUsing">上架</label>\n        </div>\n        `,confirmButtonText:"儲存編輯",cancelButtonText:"取消",showConfirmButton:!0,showCancelButton:!0,showCloseButton:!0,customClass:{input:"!w-[50%] !m-auto !text-center",title:"!pb-5"},preConfirm:()=>(t=document.getElementById("name").value,i=document.getElementById("lowestPrice").value,s=document.getElementById("highestPrice").value,o=document.getElementById("isUsing").checked,n=document.getElementById("isHighestPrice").checked,a=document.getElementById("up").checked,n||""===s||(s=""),this.examInput(t,i,s),""!==s||a?{name:t,lowestPrice:i,highestPrice:s,isUsing:o}:{name:t,lowestPrice:i,highestPrice:i,isUsing:o})});if(r){s=""===r.highestPrice?null:+r.highestPrice;const t={input:{bookingItemId:e.id,name:r.name,lowestPrice:+r.lowestPrice,highestPrice:s,bookingItemCategoryId:this.seletedTab,isUsing:r.isUsing}},i=await this.$api.updateBookingItem(t),{data:o,errors:n}=i.data;if(n)return"";o.updateBookingItem&&(await this.getBookingItemCategory(this.seletedTab,!1),this.$swal.fire({icon:"success",title:"編輯成功",showConfirmButton:!1,showCloseButton:!0,timer:3e3,timerProgressBar:!0}))}return""},deleteSingleBookingItem(e){this.$swal.fire({icon:"warning",html:'<p class="py-3 text-lg">確定要刪除項目嗎？</p>',confirmButtonText:"確認刪除",showConfirmButton:!0,showCloseButton:!0,customClass:{confirmButton:"!w-[144px] !rounded !bg-second !px-[14px] !py-2 !text-sm !text-white"}}).then((async t=>{if(t.isConfirmed){const t=e.id,i={bookingItemId:t},s=await this.$api.deleteBookingItem(i),{data:o,errors:n}=s.data;if(n)return;o.deleteBookingItem&&(await this.getBookingItemCategory(this.seletedTab,!1),this.$swal.fire({icon:"success",title:"刪除成功",showConfirmButton:!1,showCloseButton:!0,timer:3e3,timerProgressBar:!0}))}}))},deleteBookingItem(e){const t=e.filter((e=>!0===e.checked));0!==t.length?this.$swal.fire({icon:"warning",html:'<p class="py-3 text-lg">確定要刪除項目嗎？</p>',confirmButtonText:"確認刪除",showConfirmButton:!0,showCloseButton:!0,customClass:{confirmButton:"!w-[144px] !rounded !bg-second !px-[14px] !py-2 !text-sm !text-white"}}).then((async e=>{if(e.isConfirmed){const e=this.resultList.filter((e=>!0===e.checked)).map((e=>e.id)),t={bookingItemId:e},i=await this.$api.deleteBookingItem(t),{data:s,errors:o}=i.data;if(o)return;s.deleteBookingItem&&(await this.getBookingItemCategory(this.seletedTab,!1),this.$swal.fire({icon:"success",title:"刪除成功",showConfirmButton:!1,showCloseButton:!0,timer:3e3,timerProgressBar:!0})),this.$swal.fire({icon:"success",html:'<p class="py-3 text-lg">刪除成功</p>',showConfirmButton:!1,showCloseButton:!0,timer:2e3,timerProgressBar:!0}),this.isSelectAll=!1}})):this.$swal.fire({icon:"warning",html:'<p class="py-3 text-lg">請至少勾選一個項目</p>',showConfirmButton:!1,showCloseButton:!0,timer:1500,timerProgressBar:!0})},async changeBookingItemUsing(e,t){const i=e.filter((e=>!0===e.checked));0!==i.length?this.$swal.fire({icon:"warning",html:`<p class="py-3 text-lg">確定要${t?"上架":"下架"}勾選的項目嗎？</p>`,confirmButtonText:"確認",showConfirmButton:!0,showCloseButton:!0,customClass:{confirmButton:"!w-[144px] !rounded !bg-second !px-[14px] !py-2 !text-sm !text-white"}}).then((async e=>{if(e.isConfirmed){const e=i.map((e=>({bookingItemId:e.id,name:e.name,lowestPrice:e.lowestPrice,highestPrice:e.highestPrice,bookingItemCategoryId:e.bookingItemCategoryId,isUsing:t}))),s={input:e},o=await this.$api.updateBookingItem(s),{data:n,errors:a}=o.data;if(a)return"";n.updateBookingItem&&(await this.getBookingItemCategory(this.seletedTab,!1),this.$swal.fire({icon:"success",title:"編輯成功",showConfirmButton:!1,showCloseButton:!0,timer:3e3,timerProgressBar:!0}),this.isSelectAll=!1)}return""})):this.$swal.fire({icon:"warning",html:'<p class="py-3 text-lg">請至少勾選一個項目</p>',showConfirmButton:!1,showCloseButton:!0,timer:1500,timerProgressBar:!0})},async bookingItemCategoryMove(){const e=this.BookingItemCategory.map((e=>e.id)),t={input:e},i=await this.$api.updateBookingItemCategorySorting(t),{errors:s}=i.data;return s||await this.getBookingItemCategory(this.seletedTab,!1),""},async bookingItemMove(){const e=this.resultList.map((e=>e.id)),t={input:e},i=await this.$api.updateBookingItemSorting(t),{errors:s}=i.data;return s||await this.getBookingItemCategory(this.seletedTab,!1),""},handleCategory(e){this.isSelectAll=!1,this.seletedTab=e;const{bookingItem:t}=this.BookingItemCategory.filter((t=>t.id===e))[0];this.handleBookingItem(t,!1)},handleBookingItem(e,t){this.resultList=e.map((e=>{const i={};let s=0;const o=!(null!==e.highestPrice&&""!==e.highestPrice);return s=o?`${e.lowestPrice} up`:e.highestPrice===e.lowestPrice?`${e.lowestPrice}`:`${e.lowestPrice} ~ ${e.highestPrice}`,i.id=e.id,i.sort=e.sort,i.bookingItemCategoryId=e.bookingItemCategoryId,i.bookingItemCategoryName=e.bookingItemCategoryName,i.name=e.name,i.lowestPrice=e.lowestPrice,i.highestPrice=e.highestPrice,i.showPrice=s,i.checked=t,i.isUsing=e.isUsing,i}))},isNumeric(e){return/^-?\d+$/.test(e)},examInput(e,t,i){""===e||null===e||""===t||null===t?this.$swal.showValidationMessage("項目名稱、最低價為必填"):this.isNumeric(t)?""!==i&&null!==i&&(this.isNumeric(i)?+i<+t&&this.$swal.showValidationMessage("最高價格不能小於最低價格"):this.$swal.showValidationMessage("請輸入正確的最高價")):this.$swal.showValidationMessage("請輸入正確的最低價")}},computed:{},watch:{isSelectAll(){this.handleBookingItem(this.resultList,this.isSelectAll)}}},a=n,r=i(3736),l=(0,r.Z)(a,s,o,!1,null,"f5f96234",null),c=l.exports}}]);
//# sourceMappingURL=369.ff8c62f5.js.map