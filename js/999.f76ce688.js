"use strict";(self["webpackChunkbos_designer"]=self["webpackChunkbos_designer"]||[]).push([[999],{1999:function(e,t,r){r.r(t),r.d(t,{default:function(){return m}});var a=function(){var e=this,t=e._self._c;return t("main",{staticClass:"box-border h-full min-h-[calc(100vh-84px)] w-full pb-[84px]"},[t("C-Back-Nav",{attrs:{title:(""!==e.GETTER_MECHANTNAME?e.GETTER_MECHANTNAME+" - ":"")+"事件",routeTarget:{name:"ScheduleBreak"}}}),t("section",{staticClass:"relative z-0 mt-[52px] p-3"},[t("p",{staticClass:"my-2 text-center"},[e._v("新增事件")]),t("ValidationObserver",{ref:"orderForm"},[t("div",{staticClass:"my-2 flex items-center gap-2 text-left"},[t("p",{staticClass:"w-3/12"},[e._v("時間")]),t("div",{staticClass:"flex w-9/12 gap-1"},[t("ValidationProvider",{ref:"orderDate",staticClass:"w-3/5",attrs:{name:"日期",rules:"required"},scopedSlots:e._u([{key:"default",fn:function({errors:r}){return[t("VCCalendarSelect",{attrs:{"min-date":new Date,placeholder:"選擇日期",errors:r},model:{value:e.orderDate,callback:function(t){e.orderDate=t},expression:"orderDate"}})]}}])}),t("ValidationProvider",{ref:"timeList",staticClass:"w-2/5",attrs:{name:"時間",rules:"required"},scopedSlots:e._u([{key:"default",fn:function({errors:r}){return[t("C-Select",{staticClass:"w-full",attrs:{list:e.timeList,placeholder:"選擇時間","item-text":"name","item-value":"id","object-return":"",errors:r},model:{value:e.orderTime,callback:function(t){e.orderTime=t},expression:"orderTime"}})]}}])})],1)]),t("div",{staticClass:"my-2 flex gap-2 text-left"},[t("label",{staticClass:"w-3/12"},[e._v("事件說明")]),t("div",{staticClass:"relative flex w-9/12 flex-nowrap gap-1"},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.remark,expression:"remark"}],staticClass:"w-full rounded-md border border-primary/50",attrs:{name:"remark",id:"",rows:"5"},domProps:{value:e.remark},on:{input:function(t){t.target.composing||(e.remark=t.target.value)}}}),""!==e.remark?t("font-awesome-icon",{staticClass:"absolute right-2 bottom-1 text-rose-600",attrs:{icon:"fa-regular fa-xmark"},on:{click:function(t){e.remark=""}}}):e._e()],1)]),t("div",{staticClass:"fixed bottom-[100px] w-[calc(100%-24px)]"},[t("div",{staticClass:"w-full cursor-pointer bg-second py-2 px-4 text-white",on:{click:e.doFormValidate,keypress:e.doFormValidate}},[e._v("新增事件")])])])],1)],1)},s=[],i=(r(7658),r(629)),o=r(4726),n={components:{VCCalendarSelect:o.Z},name:"schedule-event",description:"預約的首頁",metaInfo:{title:"BeautyOS 設計師",titleTemplate:"%s | 事件"},data(){return{orderDate:new Date,orderTime:"",name:"",cellphone:"",remark:"",isOrderDesigner:!0,timeList:[]}},methods:{doRoute(e){this.$router.push({name:e.name})},async doFormValidate(){const e=await this.$refs.orderForm.validate();e&&this.doDelivery()},async doDelivery(){const e={date:this.$dayjs(`${this.$dayjs(this.orderDate).format("YYYY-MM-DD")} ${this.orderTime.name}`).valueOf(),text:this.remark},t=await this.$api.createEvent({input:e}),{errors:r}=t.data;r||this.fireSwalToOrder()},fireSwalToOrder(){this.$swal.fire({title:" ",html:'<div class="flex items-center justify-center my-10">\n          <img src="/designer/assets/images/success.svg" alt="" class="inline-block mr-1" /><span>新增成功</span>\n        </div>',confirmButtonText:"回列表",showConfirmButton:!0,showCloseButton:!0,customClass:{confirmButton:"!w-[144px] !rounded !bg-second !px-[14px] !py-2 !text-sm !text-white"}}).then((e=>{e.isConfirmed&&(this.remark="",this.doRoute({name:"ScheduleBreak"}))}))},async getTimeList(){this.orderTime="";const e=()=>this.isOrderDesigner?{date:this.$dayjs(this.orderDate).valueOf(),storeId:this.currentMechantId,designerId:this.userInfo.user.id}:{storeId:this.currentMechantId,date:this.$dayjs(this.orderDate).valueOf()},t="getBookingTimes",r=await this.$api[t](e()),{data:a,errors:s}=r.data;s||(this.timeList=Array.isArray(a[t])?a[t].map(((e,t)=>({name:this.$dayjs(e.time).isValid()?this.$dayjs(e.time).format("HH:mm"):e.time,id:`bookingTime${t}`,disabled:!1}))):[])}},computed:{...(0,i.rn)("userInfo",["userInfo","currentMechantId"]),...(0,i.Se)("userInfo",["GETTER_MECHANTNAME"])},watch:{orderDate:{immediate:!0,handler(){this.getTimeList()}}}},l=n,d=r(3736),c=(0,d.Z)(l,a,s,!1,null,"8c76ff4c",null),m=c.exports}}]);
//# sourceMappingURL=999.f76ce688.js.map