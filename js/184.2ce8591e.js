"use strict";(self["webpackChunkbos_designer"]=self["webpackChunkbos_designer"]||[]).push([[184],{8184:function(e,t,s){s.r(t),s.d(t,{default:function(){return c}});var r=function(){var e=this,t=e._self._c;return t("main",{staticClass:"box-border h-full min-h-[calc(100vh-84px)] w-full pb-[84px]"},[t("C-Back-Nav",{attrs:{title:(""!==e.GETTER_MECHANTNAME?e.GETTER_MECHANTNAME+" - ":"")+"預約",routeTarget:{name:"Order"}}}),t("section",{staticClass:"relative z-0 mt-[52px] p-3"},[t("div",{staticClass:"mb-4 flex items-center justify-end"},[t("div",{staticClass:"flex items-center gap-2 text-left"},[t("p",{},[e._v("顯示過往預約紀錄")]),t("div",{staticClass:"flex flex-nowrap gap-1 text-left"},[t("C-Checkbox-Full",{staticClass:"!ml-0 !w-fit",model:{value:e.searchForm.isAccurate,callback:function(t){e.$set(e.searchForm,"isAccurate",t)},expression:"searchForm.isAccurate"}})],1)])]),t("div",{staticClass:"mb-4 flex items-center justify-between gap-2"},[t("C-Input",{staticClass:"mb-0 w-full",attrs:{placeholder:"搜尋姓名、電話、代號"},on:{doFunction:function(t){return e.getOrders("byClick")}},scopedSlots:e._u([{key:"endIcon",fn:function(){return[""!==e.searchForm.keyword?t("font-awesome-icon",{staticClass:"text-rose-600",attrs:{icon:"fa-regular fa-xmark"},on:{click:e.doInitSearch}}):e._e(),t("font-awesome-icon",{attrs:{icon:"fa-regular fa-magnifying-glass"},on:{click:function(t){return e.getOrders("byClick")}}})]},proxy:!0}]),model:{value:e.searchForm.keyword,callback:function(t){e.$set(e.searchForm,"keyword",t)},expression:"searchForm.keyword"}})],1),t("div",{staticClass:"text-left text-sm"},[t("p",{staticClass:"before:contents-[''] relative my-3 pl-2 before:absolute before:inset-0 before:h-full before:w-1 before:bg-primary"},[e._v("待審查("+e._s(e.isReviewResult)+")")]),e.isReviewResult?t("div",e._l(e.reviewResult,(function(s,r){return t("div",{key:`reviewItem${r}`,staticClass:"mb-3 flex cursor-pointer items-center justify-between border-b border-solid border-primary/50 py-1 pl-2",on:{click:function(t){return e.doRoute(s,!0)},keypress:function(t){return e.doRoute(s,!0)}}},[t("div",{staticClass:"w-3/12"},[t("font-awesome-icon",{staticClass:"mr-1",attrs:{icon:"fa-regular fa-calendar-days"}}),t("span",[e._v(e._s(e._f("dateFmtROCMMDD")(s.date)))])],1),t("div",{staticClass:"w-3/12"},[t("font-awesome-icon",{staticClass:"mr-1",attrs:{icon:"fa-solid fa-clock-five"}}),t("span",[e._v(e._s(e._f("dateFmtHm")(s.date)))])],1),t("div",{staticClass:"w-3/12 overflow-hidden text-ellipsis whitespace-nowrap"},[t("font-awesome-icon",{staticClass:"mr-1",attrs:{icon:"fa-solid fa-user"}}),t("span",[e._v(e._s(s.customer.name||"--"))])],1),t("div",{staticClass:"w-3/12 min-w-[42px]"},[t("span",{staticClass:"text-sucessText"},[e._v(e._s(s.status))])]),t("div",[t("font-awesome-icon",{attrs:{icon:"fa-solid fa-angle-right"}})],1)])})),0):t("div",{staticClass:"my-3 pl-2"},[e._v("目前沒有待審查的預約")])]),t("div",{staticClass:"text-left text-sm"},[t("p",{staticClass:"before:contents-[''] relative my-3 pl-2 before:absolute before:inset-0 before:h-full before:w-1 before:bg-primary"},[e._v("預約明細("+e._s(e.isOrderResult)+")")]),e.isOrderResult?t("div",e._l(e.orderResult,(function(s,r){return t("div",{key:`reviewItem${r}`,staticClass:"mb-3 flex cursor-pointer items-center justify-between border-b border-solid border-primary/50 py-1 pl-2",on:{click:function(t){return e.doRoute(s,!1)},keypress:function(t){return e.doRoute(s,!1)}}},[t("div",{staticClass:"w-3/12"},[t("font-awesome-icon",{staticClass:"mr-1",attrs:{icon:"fa-regular fa-calendar-days"}}),t("span",[e._v(e._s(e._f("dateFmtROCMMDD")(s.date)))])],1),t("div",{staticClass:"w-3/12"},[t("font-awesome-icon",{staticClass:"mr-1",attrs:{icon:"fa-solid fa-clock-five"}}),t("span",[e._v(e._s(e._f("dateFmtHm")(s.date)))])],1),t("div",{staticClass:"w-3/12 overflow-hidden text-ellipsis whitespace-nowrap"},[t("font-awesome-icon",{staticClass:"mr-1",attrs:{icon:"fa-solid fa-user"}}),t("span",[e._v(e._s(s.customer.name||"--"))])],1),t("div",{staticClass:"w-3/12 min-w-[42px]"},[t("span",[e._v(e._s(s.status))])]),t("div",[t("font-awesome-icon",{attrs:{icon:"fa-solid fa-angle-right"}})],1)])})),0):t("div",{staticClass:"my-3 pl-2"},[e._v("目前沒有任何預約")])])])],1)},a=[],i=(s(7658),s(629)),o={name:"order-index",description:"預約的首頁",metaInfo:{title:"BeautyOS 設計師",titleTemplate:"%s | 預約列表查詢"},mounted(){this.init()},data(){return{masks:{weekdays:"WWW"},searchForm:{keyword:"",isAccurate:!0,selectedDate:this.$dayjs(this.$dayjs().format("YYYY-MM-DD")).valueOf()},monthkyOrdersDate:{start:this.$dayjs(new Date).startOf("month").valueOf(),end:this.$dayjs(new Date).endOf("month").valueOf()},attrs:[],reviewResult:[],orderResult:[],selectedAttribute:{highlight:{style:{background:"transparent"},fillMode:"solid"}}}},methods:{async init(){await Promise.all([this.getMonthlyOrders(),this.getOrders()]).then((()=>{}))},async doInitSearch(){this.searchForm.keyword="",await this.getOrders()},async getMonthlyOrders(){console.log("getMonthlyOrders");const e=await this.$api.orders({startDate:this.$dayjs(this.monthkyOrdersDate.start).isValid()?this.$dayjs(this.monthkyOrdersDate.start).valueOf():"",endDate:this.$dayjs(this.monthkyOrdersDate.end).isValid()?this.$dayjs(this.monthkyOrdersDate.end).valueOf():"",employeeId:this.userInfo.user.id,isReserved:!0}),{data:t,errors:s}=e.data;return s?{}:(this.attrs=Array.isArray(t.orders.orders)?t.orders.orders.flatMap((e=>"待審核"===e.status?[{key:`${e.id}`,customData:{class:"red"},dates:e.date}]:[{key:`${e.id}`,dates:e.date}])):[],this.$forceUpdate(),e)},async getOrders(){const e=this.$dayjs(this.searchForm.selectedDate).isValid()?this.$dayjs(this.searchForm.selectedDate).valueOf():"",t=await this.$api.orders({startDate:this.searchForm.isAccurate?null:e,endDate:null,employeeId:this.userInfo.user.id,orderKeyword:{keyword:"string"===typeof this.searchForm.keyword?this.searchForm.keyword.toLocaleLowerCase():this.searchForm.keyword,isFuzzySearch:!0},sortWay:this.searchForm.isAccurate?"ASC":"DESC",isReserved:!0}),{data:s,errors:r}=t.data;return r?{}:(this.reviewResult=s.orders.orders.filter((e=>"待審核"===e.status)),this.orderResult=s.orders.orders.filter((e=>"待審核"!==e.status)),console.log(this.reviewResult),console.log(this.orderResult),this.$forceUpdate(),t)},doRoute(e,t){this.$router.push({name:"Order-edit",query:{id:e.id,isReview:t}})},preNextMonth(e){this.monthkyOrdersDate.start=this.$dayjs(this.$dayjs(this.monthkyOrdersDate.start).add(e,"month")).startOf("month").format("YYYY-MM-DD"),this.monthkyOrdersDate.end=this.$dayjs(this.$dayjs(this.monthkyOrdersDate.end).add(e,"month")).endOf("month").format("YYYY-MM-DD")},swipeMonth(e){const t=e.year,s=e.month-1,r=new Date(t,s,1),a=new Date(t,s+1,0),i=this.$dayjs(r).format("YYYY-MM-DD"),o=this.$dayjs(a).format("YYYY-MM-DD");this.monthkyOrdersDate.start=i,this.monthkyOrdersDate.end=o}},computed:{...(0,i.rn)("userInfo",["userInfo","currentMechantId"]),...(0,i.Se)("userInfo",["GETTER_MECHANTNAME"]),isReviewResult(){return this.reviewResult.length},isOrderResult(){return this.orderResult.length}},watch:{"searchForm.selectedDate":{handler(){this.searchForm.selectedDate&&this.getOrders()}},"searchForm.isAccurate":{handler(){this.searchForm.selectedDate&&this.getOrders()}},monthkyOrdersDate:{deep:!0,handler(){this.getMonthlyOrders()}}}},n=o,d=s(3736),l=(0,d.Z)(n,r,a,!1,null,"47f1d232",null),c=l.exports}}]);
//# sourceMappingURL=184.2ce8591e.js.map